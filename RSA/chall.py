from Crypto.Util.number import *

# This isn't the flag. It was when I was the program, but I REDACTED it when I uploaded the file
flag = b"ZeroDays{REDACTED}"
m = bytes_to_long(flag)

# Let's generate our big primes
p = getPrime(512)
q = getPrime(512)

# Let's now calculate out modulus
n = p*q

# Okay, time to select an encryption key, I'll choose the prime number 65537
e = 65537

# Now let's calculate our decryption key
d = pow(e, -1, (p-1)*(q-1))

# We can now encrypt the flag
c = pow(m,e,n)

# I'm going to give you some values, try to figure out how to decrypt the key using them
print(f"{c = }")
print(f"{d = }")
print(f"{p = }")
print(f"{q = }")

# Here's the output, so I don't have to give you a second file
"""
c = 56138183880230540207280101558936867536447342756048845631873856991245652463168584090221275675914392801212310112128145952742232813758992772024596655822288771891553530327541485381014729862203636854576430985739299715170055818938736428810328912757174535100371329679708980896642372685653608261056037683188979158626
d = 78350533167716724210953219297672345109482748116632518530404309165858976494845008683587053100251618594716323140512814495218340961738306206056732465731827376658503474390032479158024323801077218573853501207677310894739719448331655359131676918521750622673770311984363478387260495343161735258914819241211593779169
p = 12489749224043196309038733661337119693063172302528668238921498036172149433795069700053619791168444063970505911480156219482418757935854956979785145107081763
q = 7038862143945515497034997018174138929017679178639854682314454877420069902943458478997518392389789435409691735305654503643871769943988121935550850758096263
"""
